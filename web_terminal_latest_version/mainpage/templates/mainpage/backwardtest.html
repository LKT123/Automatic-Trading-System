{% load static %}

<!DOCTYPE html>
<html lang='en'>

<head>
    <meta charset='utf-8'>
    <title>MacroDigest Panel</title>
</head>

<body>
    <div>
        <style>
            * {
                box-sizing: border-box;
            }

            body {
                margin: 0;
            }

            * {
                box-sizing: border-box;
            }

            body {
                margin-top: 0px;
                margin-right: 0px;
                margin-bottom: 0px;
                margin-left: 0px;
                font-family: -apple-system, BlinkMacSystemFont, "Helvetica Neue", Helvetica, Roboto, Arial, "PingFang SC", "Hiragino Sans GB", "Microsoft Yahei", "Microsoft Jhenghei", sans-serif;
            }

            .logo path {
                pointer-events: none;
                fill: none;
                stroke-linecap: round;
                stroke-width: 7;
                stroke: rgb(255, 255, 255);
            }

            .wechat-group img {
                max-width: 220px;
                height: auto;
                border-top-left-radius: 8px;
                border-top-right-radius: 8px;
                border-bottom-right-radius: 8px;
                border-bottom-left-radius: 8px;
                margin-top: 0px;
                margin-right: auto;
                margin-bottom: 0px;
                margin-left: auto;
                width: 100%;
            }

            .welcome-img img {
                width: 100%;
            }

            .bg-gradient-primary {
                border-top-left-radius: 8px;
                border-top-right-radius: 8px;
                border-bottom-right-radius: 8px;
                border-bottom-left-radius: 8px;
            }

            .img-fluid {
                height: 640.0000732421875px;
                width: 1276.6870854492188px;
            }
        </style>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="Control Panel For Trading Terminal" />
        <meta name="keywords"
            content="Trading Bot" />
        <meta name="author" content="MacroDigest" />
        <title>MacroDigest Control Panel</title>
        <link rel="preload" href="{% static 'fonts/Unicons.woff2' %}" as="font" type="font/woff2" crossorigin="" />
        <link rel="shortcut icon" href="{% static 'img/favicon.png' %}" />
        <link rel="stylesheet" href="{% static 'css/plugins.css' %}" />
        <link rel="stylesheet" href="{% static 'css/style.css' %}" />
        <link rel="stylesheet" href="{% static 'css/purple.css' %}" />
        <link rel="stylesheet" href="{% static 'css/custom_backwardtest.css' %}" />
        <link rel="preload" href="{% static 'css/thicccboi.css' %}" as="style" />
        <nav id="sticky-navbar" class="navbar navbar-expand-lg classic transparent navbar-light navbar-clone fixed">
            <div class="container flex-lg-row flex-nowrap align-items-center">
                <div class="navbar-brand w-100">
                    <a href="https://htmlpage.cn">
                        <img src="{% static 'img/logo-small-svg.svg' %}" alt="" />
                    </a>
                </div>
                <div class="navbar-collapse offcanvas offcanvas-nav offcanvas-start">
                    <div class="offcanvas-header d-lg-none">
                        <h3 class="text-white fs-30 mb-0">HTMLPAGE.CN</h3><button type="button"
                            data-bs-dismiss="offcanvas" aria-label="Close"
                            class="btn-close btn-close-white">Send</button>
                    </div>
                    <div class="offcanvas-body ms-lg-auto d-flex flex-column h-100">
                        <ul class="navbar-nav">
                            <li class="nav-item"><a href="{% url 'home' %}" class="nav-link">Home</a></li>
                            <li class="nav-item dropdown"><a href="#" data-bs-toggle="dropdown"
                                    class="nav-link dropdown-toggle">MacroDigest</a>
                                <ul class="dropdown-menu">
                                    <li class="dropdown dropdown-submenu dropend"><a href="#" data-bs-toggle="dropdown"
                                            class="dropdown-item dropdown-toggle">用户体验</a>
                                        <ul class="dropdown-menu">
                                            <li class="nav-item"><a href="./services.html"
                                                    class="dropdown-item">交互体验设计</a></li>
                                            <li class="nav-item"><a href="./services2.html"
                                                    class="dropdown-item">体验与用户行为</a></li>
                                        </ul>
                                    </li>
                                    <li class="dropdown dropdown-submenu dropend"><a href="#" data-bs-toggle="dropdown"
                                            class="dropdown-item dropdown-toggle">视觉设计</a>
                                        <ul class="dropdown-menu">
                                            <li class="nav-item"><a href="./about.html" class="dropdown-item">界面设计</a>
                                            </li>
                                            <li class="nav-item"><a href="./about2.html" class="dropdown-item">平面设计</a>
                                            </li>
                                        </ul>
                                    </li>
                                    <li class="nav-item"><a href="./pricing.html" class="dropdown-item">架构设计</a></li>
                                </ul>
                            </li>
                            <li class="nav-item dropdown"><a href="#" data-bs-toggle="dropdown"
                                    class="nav-link dropdown-toggle">Economic Calendar</a>
                                <div class="dropdown-menu dropdown-lg">
                                    <div class="dropdown-lg-content">
                                        <div>
                                            <h6 class="dropdown-header">体验设计</h6>
                                            <ul class="list-unstyled">
                                                <li><a href="./projects.html" class="dropdown-item">某电商平台</a></li>
                                                <li><a href="./projects2.html" class="dropdown-item">某电商平台</a></li>
                                            </ul>
                                        </div><!-- /.column -->
                                        <div>
                                            <h6 class="dropdown-header">交互设计</h6>
                                            <ul class="list-unstyled">
                                                <li><a href="./single-project.html" class="dropdown-item">某游戏平台</a></li>
                                                <li><a href="./single-project2.html" class="dropdown-item">某游戏平台</a>
                                                </li>
                                            </ul>
                                        </div><!-- /.column -->
                                    </div><!-- /auto-column -->
                                </div>
                            </li>
                            <li class="nav-item dropdown"><a href="#" data-bs-toggle="dropdown"
                                    class="nav-link dropdown-toggle">About us</a>
                                <ul class="dropdown-menu">
                                    <li class="nav-item"><a href="./blog.html" class="dropdown-item">企业介绍</a></li>
                                    <li class="nav-item"><a href="./blog2.html" class="dropdown-item">企业文化</a></li>
                                    <li class="dropdown dropdown-submenu dropend"><a href="#" data-bs-toggle="dropdown"
                                            class="dropdown-item dropdown-toggle">联系方式</a>
                                        <ul class="dropdown-menu">
                                            <li class="nav-item"><a href="./blog-post.html"
                                                    class="dropdown-item">联系电话</a></li>
                                            <li class="nav-item"><a href="./blog-post2.html"
                                                    class="dropdown-item">电子邮件</a></li>
                                        </ul>
                                    </li>
                                </ul>
                            </li>
                        </ul><!-- /.navbar-nav -->
                        <div class="offcanvas-footer d-lg-none">
                            <div><a href="mailto:first.last@email.com" class="link-inverse">help@lapus.cn</a><br /> 00
                                (123) 456 78 90 <br />
                                <nav class="nav social social-white mt-4"><a href="#"><i
                                            class="uil uil-twitter"></i></a><a href="#"><i
                                            class="uil uil-facebook-f"></i></a><a href="#"><i
                                            class="uil uil-dribbble"></i></a><a href="#"><i
                                            class="uil uil-instagram"></i></a><a href="#"><i
                                            class="uil uil-youtube"></i></a></nav><!-- /.social -->
                            </div>
                        </div><!-- /.offcanvas-footer -->
                    </div><!-- /.offcanvas-body -->
                </div><!-- /.navbar-collapse -->
                <div class="navbar-other ms-lg-4"><!-- /.navbar-nav --></div><!-- /.navbar-other -->
            </div><!-- /.container -->
        </nav>
        <div class="content-wrapper">
            <header class="wrapper bg-soft-primary">
                <nav class="navbar navbar-expand-lg fancy navbar-light navbar-bg-light caret-none">
                    <div class="container">
                        <div
                            class="navbar-collapse-wrapper bg-white d-flex flex-row flex-nowrap w-100 justify-content-between align-items-center">
                            <div class="navbar-brand w-100">
                                <a href="https://htmlpage.cn">
                                    <img src="{% static 'img/logo-small-svg.svg' %}" alt="" />
                                </a>
                            </div>
                            <div class="navbar-collapse offcanvas offcanvas-nav offcanvas-start">
                                <div class="offcanvas-header d-lg-none">
                                    <h3 class="text-white fs-30 mb-0">HTMLPAGE.CN</h3><button type="button"
                                        data-bs-dismiss="offcanvas" aria-label="Close"
                                        class="btn-close btn-close-white">Send</button>
                                </div>
                                <div class="offcanvas-body ms-lg-auto d-flex flex-column h-100">
                                    <ul class="navbar-nav">
                                        <li class="nav-item"><a href="{% url 'home' %}" class="nav-link">Home</a>
                                        </li>
                                        <li class="nav-item dropdown"><a href="#" data-bs-toggle="dropdown"
                                                class="nav-link dropdown-toggle">MacroDigest</a>
                                            <ul class="dropdown-menu">
                                                <li class="dropdown dropdown-submenu dropend"><a href="#"
                                                        data-bs-toggle="dropdown"
                                                        class="dropdown-item dropdown-toggle">用户体验</a>
                                                    <ul class="dropdown-menu">
                                                        <li class="nav-item"><a href="./services.html"
                                                                class="dropdown-item">交互体验设计</a></li>
                                                        <li class="nav-item"><a href="./services2.html"
                                                                class="dropdown-item">体验与用户行为</a></li>
                                                    </ul>
                                                </li>
                                                <li class="dropdown dropdown-submenu dropend"><a href="#"
                                                        data-bs-toggle="dropdown"
                                                        class="dropdown-item dropdown-toggle">视觉设计</a>
                                                    <ul class="dropdown-menu">
                                                        <li class="nav-item"><a href="./about.html"
                                                                class="dropdown-item">界面设计</a></li>
                                                        <li class="nav-item"><a href="./about2.html"
                                                                class="dropdown-item">平面设计</a></li>
                                                    </ul>
                                                </li>
                                                <li class="nav-item"><a href="./pricing.html"
                                                        class="dropdown-item">架构设计</a></li>
                                            </ul>
                                        </li>
                                        <li class="nav-item dropdown"><a href="#" data-bs-toggle="dropdown"
                                                class="nav-link dropdown-toggle">Economic Calendar</a>
                                            <div class="dropdown-menu dropdown-lg">
                                                <div class="dropdown-lg-content">
                                                    <div>
                                                        <h6 class="dropdown-header">体验设计</h6>
                                                        <ul class="list-unstyled">
                                                            <li><a href="./projects.html"
                                                                    class="dropdown-item">某电商平台</a></li>
                                                            <li><a href="./projects2.html"
                                                                    class="dropdown-item">某电商平台</a></li>
                                                        </ul>
                                                    </div><!-- /.column -->
                                                    <div>
                                                        <h6 class="dropdown-header">交互设计</h6>
                                                        <ul class="list-unstyled">
                                                            <li><a href="./single-project.html"
                                                                    class="dropdown-item">某游戏平台</a></li>
                                                            <li><a href="./single-project2.html"
                                                                    class="dropdown-item">某游戏平台</a></li>
                                                        </ul>
                                                    </div><!-- /.column -->
                                                </div><!-- /auto-column -->
                                            </div>
                                        </li>
                                        <li class="nav-item dropdown"><a href="#" data-bs-toggle="dropdown"
                                                class="nav-link dropdown-toggle">About us</a>
                                            <ul class="dropdown-menu">
                                                <li class="nav-item"><a href="./blog.html"
                                                        class="dropdown-item">企业介绍</a></li>
                                                <li class="nav-item"><a href="./blog2.html"
                                                        class="dropdown-item">企业文化</a></li>
                                                <li class="dropdown dropdown-submenu dropend"><a href="#"
                                                        data-bs-toggle="dropdown"
                                                        class="dropdown-item dropdown-toggle">联系方式</a>
                                                    <ul class="dropdown-menu">
                                                        <li class="nav-item"><a href="./blog-post.html"
                                                                class="dropdown-item">联系电话</a></li>
                                                        <li class="nav-item"><a href="./blog-post2.html"
                                                                class="dropdown-item">电子邮件</a></li>
                                                    </ul>
                                                </li>
                                            </ul>
                                        </li>
                                    </ul><!-- /.navbar-nav -->
                                    <div class="offcanvas-footer d-lg-none">
                                        <div><a href="mailto:first.last@email.com"
                                                class="link-inverse">help@lapus.cn</a><br /> 13799264013 <br />
                                            <nav class="nav social social-white mt-4"><a href="#"><i
                                                        class="uil uil-twitter"></i></a><a href="#"><i
                                                        class="uil uil-facebook-f"></i></a><a href="#"><i
                                                        class="uil uil-dribbble"></i></a><a href="#"><i
                                                        class="uil uil-instagram"></i></a><a href="#"><i
                                                        class="uil uil-youtube"></i></a></nav><!-- /.social -->
                                        </div>
                                    </div><!-- /.offcanvas-footer -->
                                </div><!-- /.offcanvas-body -->
                            </div><!-- /.navbar-collapse --><!-- /.navbar-other -->
                        </div><!-- /.navbar-collapse-wrapper -->
                    </div><!-- /.container -->
                </nav><!-- /.navbar -->
            </header><!-- /header -->
            <section class="wrapper bg-gradient-primary">
                <div class="container py-14 pt-md-3 pb-md-18">
                    {% comment %} <div class="row text-center"><!-- /column --></div><!-- /.row -->
                    <div data-cues="slideInDown" data-group="join" data-delay="900"
                        class="d-flex justify-content-center"><span><a href="{% url 'timesfmweb' %}"
                                class="btn btn-lg btn-primary rounded-pill mx-1">Timesfm Forecast</a><a
                                href="{% url 'backwardtest' %}"
                                class="btn btn-lg btn-outline-primary rounded-pill mx-1">Backward Test</a><a
                                href="{% url 'analysis' %}"
                                class="btn btn-lg btn-primary rounded-pill mx-1">Analysis Result</a><a
                                href="{% url 'account' %}"
                                class="btn btn-lg btn-outline-primary rounded-pill mx-1">Account Info</a><a
                                href="{% url 'setting' %}"
                                class="btn btn-lg btn-primary rounded-pill mx-1">Setting &amp;
                                System</a></span><span></span></div><!-- /div -->          data-cue="fadeIn" data-delay="1600"    {% endcomment %}
                    <div class="row mt-12">
                            
                        <figure>
                            <h2 class="display-4 mb-3">Backward test on {{stock_code}} </h2>
                        </figure>
                            <form method="post" id="backwardtest_stockform">
                                {% csrf_token %}
                                <div class="d-flex justify-content-center">

                                    <div>
                                        <button type="button" class="collapsible rounded-pill btn btn-lg btn-outline-primary">Indicators &amp; Setting </button>
                                        <div id="checkbox-container" class="checkbox-container content" style="width: 48%;">
                                            {% for checkbox in backwardtest_stockform.economic_indicators %}
                                            <div class="form-check">
                                                <label class="form-check-label" for="{{ checkbox.id_for_label }}">
                                                {{ checkbox.tag }} <a class = "btn "> {{ checkbox.choice_label }}</a>
                                                </label>
                                            </div>
                                            {% endfor %}
                                            {{ backwardtest_stockform.economic_indicators.errors }}
                                        </div>
                                    </div>
                                    <div class="form-group nav-item nav-link mx-1">
                                        <label for="{{ backwardtest_stockform.start_date.id_for_label }}">Start Date:</label>
                                        {{ backwardtest_stockform.start_date }}
                                    </div>
                                    <div class="form-group nav-item nav-link mx-1">
                                        <label for="{{ backwardtest_stockform.end_date.id_for_label }}">End Date:</label>
                                        {{ backwardtest_stockform.end_date }}
                                    </div>

                                    <div class="form-group nav-item nav-link mx-1">
                                        <label for="{{ backwardtest_stockform.stock_code.id_for_label }}">Stock Code:</label>
                                        {{ backwardtest_stockform.stock_code }}
                                    </div>

                                    <button type="submit" class="btn btn-lg btn-primary rounded-pill mx-1">Submit</button>
                                </div>
                            </form>

                    </div><!-- /.row -->

                    <div>
                        <p>GRAPH SECTION</p>
                    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
                    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-annotation@1.0.2"></script>

                    <canvas id="backward_test_result_chart"></canvas>
                    <script>
                        document.addEventListener('DOMContentLoaded', function () {
                            const ctx = document.getElementById('backward_test_result_chart').getContext('2d');
                            const accountResult = {{ account_result|safe }};
                            const baselineResult = {{ baseline_result|safe }};
                            const decisionArray = {{ decision_array|safe }};
                            const maxIndex = accountResult.length - 1; // Assuming both arrays are of the same length
                        
                            const chart = new Chart(ctx, {
                                type: 'line',
                                data: {
                                    labels: accountResult.map((_, index) => index),
                                    datasets: [{
                                        label: 'Account Result',
                                        data: accountResult,
                                        borderColor: 'blue',
                                        backgroundColor: 'transparent',
                                        fill: false,
                                    }, {
                                        label: 'Baseline Result',
                                        data: baselineResult,
                                        borderColor: 'red',
                                        backgroundColor: 'transparent',
                                        fill: false,
                                    }]
                                },
                                options: {
                                    scales: {
                                        x: {
                                            type: 'linear',
                                            position: 'bottom',
                                            min: 0,
                                            max: maxIndex // Set the maximum x value to the last index of your data arrays
                                        }
                                    },
                                    plugins: {
                                        annotation: {
                                            annotations: createAnnotations(decisionArray)
                                        }
                                    }
                                }
                            });
                        
                            function createAnnotations(decisionArray) {
                                let annotations = {};
                                decisionArray.forEach((value, index) => {
                                    if (value !== 0) { // Only create annotations for non-zero values
                                        const color = value === 1 ? 'rgba(0, 0, 255, 0.2)' : 'rgba(128, 0, 128, 0.2)';
                                        annotations[`segment${index}`] = {
                                            type: 'box',
                                            xMin: index,
                                            xMax: index + 1, // Assuming each index represents a unit interval
                                            backgroundColor: color,
                                            borderWidth: 0,
                                        };
                                    }
                                });
                                return annotations;
                            }
                        });
                    </script>
                    <div>
                        Max Loss:{{ max_loss }}
                        Total Profit: {{ profit }}

                    </div>
                    </div>
                    
                    



                </div><!-- /.container -->
            </section><!-- /section -->

            <section class="wrapper bg-light"><!-- /.container --></section><!-- /section -->
        </div><!-- /.content-wrapper -->
        <footer class="bg-gradient-reverse-primary">
            <div class="container pt-13 pt-md-15 pb-7">
                <div data-image-src="{% static 'img/bg2.jpg' %}"
                    class="card image-wrapper bg-full bg-image bg-overlay bg-overlay-400 mb-13"><!--/.card-body -->
                </div><!--/.card -->
                <div class="row gy-6 gy-lg-0">
                    <div class="col-lg-4">
                        <div class="widget">
                            <h3 class="h2 mb-3">Join us</h3>
                            <p class="lead mb-5">Feel Free to join us and contribute to this project. </p><a href="#"
                                class="btn btn-primary rounded-pill">Join</a>
                        </div><!-- /.widget -->
                    </div><!-- /column -->
                    <div class="col-md-4 col-lg-2 offset-lg-2">
                        <div class="widget">
                            <h4 class="widget-title mb-3">Contact</h4>
                            <ul class="list-unstyled text-reset mb-0">
                                <li><a href="#">China·Beijing</a></li>
                                <li><a href="#">hel053@ucsd.edu<br /></a></li>
                                <li><a href="#">(+86) 13661235860</a></li>
                            </ul>
                        </div><!-- /.widget -->
                    </div><!-- /column -->
                    <div class="col-md-4 col-lg-2">
                        <div class="widget">
                            <h4 class="widget-title mb-3">More About us</h4>
                            <ul class="list-unstyled text-reset mb-0">
                                <li><a href="#">关于我们</a></li>
                                <li><a href="#">解决方案</a></li>
                                <li><a href="#">项目案例</a></li>
                                <li><a href="#">隐私条款</a></li>
                                <li><a href="#">相关法规</a></li>
                            </ul>
                        </div><!-- /.widget -->
                    </div><!-- /column -->
                    <div class="col-md-4 col-lg-2">
                        <div class="widget">
                            <h4 class="widget-title mb-3">Email</h4>
                            <address>您可以发送邮件到：</address><a href="mailto:first.last@email.com"
                                class="link-body">hel053@ucsd.edu<br /></a><br />
                        </div><!-- /.widget -->
                    </div><!-- /column -->
                </div><!--/.row -->
                <hr class="mt-13 mt-md-15 mb-7" />
                <div class="d-md-flex align-items-center justify-content-between">
                    <p class="mb-2 mb-lg-0">© 2024 MacroDigest. All rights reserved.</p><!-- /.social -->
                </div><!-- /div -->
            </div><!-- /.container -->
        </footer>
        <script src="{% static 'js/plugins.js' %}"></script>
        <script src="{% static 'js/theme.js' %}"></script>
        <script src="{% static 'js/custom_backwardtest.js' %}"></script>
    </div>
</body>

</html>